## The implementation of the prediction methods presented in the study by Fourati et al. 2015

Six distinct models were presented in the study by Fourati et al. 2015, which displayed predictive capabilities of the HBV vaccine. However, one of the models was utilizing red blood cell counts which are not present in the CMI-PB datasets and hence this model was not implemented. The five other models were implemented and evaluated. The first model was an aggregate score of genes found to be associated with age, named BioAge in the original manuscript. The BioAge was defined as the difference in the average expression of 9 gene modules (M12-M20) overexpressed in elderly (age ≥ 65) and 11 gene modules (M1-M9) overexpressed in non-elderly (age ≤ 40). Next, a model utilizing the M1 module alone and another model consisting of the M1 and M16 modules together, were presented in the original study as being more predictive than the actual BioAge score. Besides the BioAge scores, two machine learning models were used to predict the vaccine response to the HBV vaccine. Firstly, a naive Bayes classifier was presented, which was based on the top 15 differentially expressed genes between HBV vaccine responders and non-responders. As described in the original study the ratio between the post-probabilities of the naive Bayes model was used to predict the antibody responses. Secondly, a multivariate logistic regression model combining four flow cytometric markers was utilized to predict the HBV vaccination-induced immune response. Here the log-odds in the logistic model were utilized to predict the vaccination response.
Microarray gene expression data was utilized in the original study, which was preprocessed with log2 transformation of quantile normalized intensity values. Hence there was no obvious choice of which preprocessing step to be performed for the CMI-PB gene expression datasets. Therefore, both the TPM and DESeq2 VST normalizations were tested. The DSeq2 VST normalization yielded slightly better results. There were a total of 1,976 genes symbols in the 20 modules used for calculating the BioAge score. It was possible to identify expression levels for 1,955 of the genes in the CMI-PB datasets, equivalent to 98.94%. The naive Bayes classifier was developed using Affymetrix probe IDs as identifiers for the 15-gene signature. It was not possible to identify a mapping from probe IDs of the Affymetrix HuRSTA-2a520709 chips used in the original study to the Ensembl IDs used in the CMI-PB datasets. Therefore, identifiers had to be translated first to gene symbols and then to Ensembl IDs. Translation from probe IDs to gene symbols was performed using the supplementary information table provided with the original manuscript. As the gene haptoglobin (HP) was specifically mentioned as being part of the 15-gene signature in the manuscript, the gene symbol “HPR HP” was changed to “HP” in order to identify the Ensembl ID in the CMI-PB datasets. Although the naive Bayes classifier was developed on 15 unique probe IDs, it should be noted that these mapped to only 13 unique gene symbols. Of the 13 unique gene symbols, it was possible to identify 10 of them with Ensembl IDs in the CMI-PB gene expression datasets. There was not found a clear expected directionality of the results presented in the original manuscript.
