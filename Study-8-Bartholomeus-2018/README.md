## The implementation of the prediction methods presented in the study by Bartholomeus et al. 2018

In the study by Bartholomeus et al. 2018 [56], a naive Bayes classifier was presented as well as 23 differentially expressed genes (DEGs) in HBV vaccination responders versus non-responders. In the original manuscript, the naive Bayes classifier was trained on the first 10 principal components (PCs) from a principal component analysis (PCA). However, to obtain better performance the authors changed the classifier to utilize only the first 5 PCs. To resemble the methodology in the study, a PCA of the CMI-PB gene expression datasets was performed. The naive Bayes classifier was then utilized to predict class probabilities of the vaccine responses using the 5 PCs from the CMI-PB data. Although the 23 DEGs were not evaluated in the original study as a predictive model, it was viewed as a gene signature, which had the potential to distinguish between HBV vaccine responses. Consequently, a gene set score was calculated for the TPM normalized expression values of 23 DEGs, as described in section X.X Calculation of gene signature scores, and evaluated on the CMI-PB datasets. The 23 DEGs are presented in Supplementary Table S7. In the original study the RNA-seq gene expression data was filtered and preprocessed before performing the PCA. Firstly, genes with a count sum across all subjects below 100 were removed. Secondly, the median gene count was calculated for each subject, where genes with counts equal to zero were excluded. Lastly, the gene counts were normalized using the formula: (count * 10,000)/median)/10,000. These preprocessing steps were performed for the CMI-PB datasets, before the PCA analysis was carried out. There was no expected directionality presented for either of the prediction methods in the original study.
